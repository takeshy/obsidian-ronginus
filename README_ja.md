# Ronginus - Obsidian用AI討論プラグイン

Ronginusは、複数のAI CLIツール（Gemini CLI、Claude Code、Codex CLI）とユーザーの間で構造化された討論を可能にするObsidianプラグインです。参加者は与えられたテーマについて議論し、ターンごとに視点を共有し、投票で最良の結論を決定します。

![新規討論](new.png)

## 機能

- **柔軟な参加者選択**: 討論に参加するAIアシスタントとユーザーを選択
- **ユーザー参加**: AI参加者と一緒に自分も討論に参加可能
- **役割の割り当て**: 参加者に役割を割り当て（例: 「肯定派」「批判派」「中立」）。同じAIでも異なる役割で複数回参加させることで、同一モデルから異なる視点の意見を引き出すことができます。
- **並列処理**: AIの回答とユーザー入力が同時に進行
- **ターン制の議論**: 設定可能なターン数（デフォルト: 2回）で、参加者が互いの視点を共有し応答。最終ターンが結論フェーズとなります。
- **投票システム**: 全参加者（AIとユーザー）が最良の結論に投票。同票の場合は「引き分け」として全員を表示
- **自動ノートエクスポート**: 完全な討論の議事録をMarkdownノートとして保存
- **i18n対応**: 英語と日本語をサポート（Obsidianのロケールから自動検出）

## 必要条件

**少なくとも1つ**のCLIツールがインストールされ、認証されている必要があります（または自分だけで討論することも可能）：

### Gemini CLI
```bash
npm install -g @google/gemini-cli
gemini auth login
```

### Claude Code CLI
```bash
npm install -g @anthropic-ai/claude-code
claude login
```

### Codex CLI
```bash
npm install -g @openai/codex
# OPENAI_API_KEY環境変数を設定
```

## インストール

### 手動インストール
1. 最新リリースから`main.js`、`manifest.json`、`styles.css`をダウンロード
2. Vaultの`.obsidian/plugins/`ディレクトリに`ronginus`フォルダを作成
3. ダウンロードしたファイルをフォルダにコピー
4. Obsidianの設定 > コミュニティプラグインでプラグインを有効化

### ソースからビルド
```bash
git clone https://github.com/takeshy/obsidian-ronginus
cd obsidian-ronginus
npm install
npm run build
```

## 使い方

### 1. CLIツールの認証
1. Obsidian設定 > Ronginusを開く
2. インストール済みの各CLIの「認証」をクリック
3. 少なくとも1つのCLIが「認証済み」ステータスになっていることを確認（または自分を参加者として追加）

![設定 - CLIプロバイダー](setting1.png)

### 2. 討論の開始
1. リボンの討論アイコンをクリック、またはコマンドパレットで「Open AI Debate」を実行
2. 討論のテーマ/トピックを入力
3. ターン数を設定（1-10）
4. **参加者の設定**:
   - 討論参加者を追加/削除
   - 役割を割り当て（任意、例: 「肯定派」「批判派」）
   - 「ユーザー」として自分を追加して参加
   - 投票参加者は討論参加者から自動的に同期されます
5. 「討論開始」をクリック

### 3. 討論への参加
- AI参加者がテーマについて並列で思考します
- あなたが参加者の場合、AIが回答を生成している間に自分の回答を入力
- 各ターン後、全参加者が互いの回答を確認
- 最終ターンで、各参加者が結論を提示

![討論進行中](start_debate.png)

![ユーザー入力](user_input.png)

### 4. 最良の結論に投票
- 全参加者（AIとユーザー）が最良の結論に投票
- 自分を含む任意の参加者に投票可能
- 多数決で勝者が決定

![ユーザー投票](user_vote.png)

![投票結果](vote_result.png)

### 5. 結果の保存
- 「ノートに保存」をクリックして、討論全体をMarkdownファイルとしてエクスポート
- ノートは設定された出力フォルダに保存されます（デフォルト: "Debates"）

## 設定

| 設定 | 説明 |
|------|------|
| 出力フォルダ | 討論ノートを保存するフォルダ（デフォルト: "Debates"） |
| システムプロンプト | すべてのAI参加者に与える指示 |
| 結論プロンプト | 最終結論フェーズ用のプロンプト |
| 投票プロンプト | 投票フェーズ用のプロンプト（フォーマット指示は自動付与） |

![設定 - プロンプト](setting2.png)

## デフォルトプロンプト

設定でプロンプトをカスタマイズできます。以下は参照用のデフォルト値です：

### システムプロンプト
```
他のAIアシスタントとテーマについて議論しています。簡潔に考えを述べてください。
```

### 結論プロンプト
```
これまでの議論を踏まえて、テーマについての最終結論を述べてください。
明確かつ決定的に。立場を整理された形でまとめてください。
回答は「結論：」から始めてください。
```

### 投票プロンプト
```
全参加者の結論を確認しました。
最も優れた結論に投票してください（自分の結論が最も優れていると思えば、自分に投票しても構いません）。
明確さ、論理的な推論、完全性を考慮してください。
```

> **注意**: フォーマット指示（`形式：投票: [名前] - [理由]`）は投票プロンプトに自動的に付与されます。これは投票の解析に必要なため、カスタマイズ時に含める必要はありません。

## 仕組み

```
テーマ入力 + 参加者選択
    ↓
┌─────────────────────────────────────┐
│         ターン 1（並列）             │
│  AI 1 ──┬── AI 2 ──┬── ユーザー     │
│ (役割)  │  (役割)  │   (役割)       │
│         │          │                │
│       回答        回答              │
└─────────────────────────────────────┘
    ↓ （回答を共有）
┌─────────────────────────────────────┐
│     ターン 2 ~ N-1（並列）           │
│  各参加者が他の参加者の回答を見て   │
│  洗練された考えを提供               │
└─────────────────────────────────────┘
    ↓ （最終ターン = 結論）
┌─────────────────────────────────────┐
│     最終ターン（並列）               │
│  各参加者が最終結論を提示           │
│  （結論セクションに表示）           │
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│         投票フェーズ                 │
│  全参加者が最良の結論に投票         │
│  （自分または他者に投票可能）        │
└─────────────────────────────────────┘
    ↓
勝者発表（多数決）
または引き分け（同票の場合）
```

## ライセンス

MIT License

## クレジット

- [Obsidian Plugin API](https://github.com/obsidianmd/obsidian-api)を使用して構築
- [Gemini CLI](https://github.com/google/gemini-cli)、[Claude Code](https://github.com/anthropics/claude-code)、[Codex CLI](https://github.com/openai/codex)を使用
